<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="keywords" content="Accessibility, Access to nutrition, Passive location data">

<title>Equitable Access to Nutrition in Utah - 5&nbsp; Application</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06_conclusion.html" rel="next">
<link href="./04_estimation.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./05_scenarios.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Application</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Equitable Access to Nutrition in Utah</a> 
        <div class="sidebar-tools-main">
    <a href="./Equitable-Access-to-Nutrition-in-Utah.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_litreview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Literature Review</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Results</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_scenarios.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Application</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Conclusions and Recommendations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./acknowledgments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgments</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#scenario-descriptions" id="toc-scenario-descriptions" class="nav-link active" data-scroll-target="#scenario-descriptions"><span class="header-section-number">5.1</span> Scenario Descriptions</a>
  <ul class="collapse">
  <li><a href="#erect-a-new-store" id="toc-erect-a-new-store" class="nav-link" data-scroll-target="#erect-a-new-store"><span class="header-section-number">5.1.1</span> Erect a new store</a></li>
  <li><a href="#improve-an-existing-store" id="toc-improve-an-existing-store" class="nav-link" data-scroll-target="#improve-an-existing-store"><span class="header-section-number">5.1.2</span> Improve an existing store</a></li>
  <li><a href="#improve-transit-and-non-motorized-transport" id="toc-improve-transit-and-non-motorized-transport" class="nav-link" data-scroll-target="#improve-transit-and-non-motorized-transport"><span class="header-section-number">5.1.3</span> Improve transit and non-motorized transport</a></li>
  </ul></li>
  <li><a href="#scenario-results" id="toc-scenario-results" class="nav-link" data-scroll-target="#scenario-results"><span class="header-section-number">5.2</span> Scenario Results</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-scenarios" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Application</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In this section, we develop a series of scenarios to which we apply the models estimated in <a href="04_estimation.html"><span>Chapter&nbsp;4</span></a>. These scenarios are constructed to ascertain what may be the best strategy to improve nutrition access in a community. We first describe how each scenario was constructed, and then discuss the results together.</p>
<p>The accessibility of each scenario was to be determined using the approximated utility coefficients of the All model estimated in <a href="04_estimation.html"><span>Chapter&nbsp;4</span></a>, <span id="eq-scenu"><span class="math display">
U_{ij}= \beta_{MCLS}( k_{ij}) +  \beta_{n-a} (\mathrm{NEMS-Availability}) +
  \beta_{n-c}\mathrm({NEMS-Cost}) + \\ \beta_{mkt} (\mathrm{Market Basket}) + \pmb{\beta}_{type}(\mathrm{Type})  
\tag{5.1}</span></span> and the total access benefit is defined as the consumer surplus given in <a href="03_methods.html#eq-cs">Equation&nbsp;<span>3.3</span></a>. Note that this benefit is denominated in units of utility <span class="citation" data-cites="ben-akiva1985">(<a href="references.html#ref-ben-akiva1985" role="doc-biblioref">Ben-Akiva &amp; Lerman, 1985</a>)</span>, and the coefficients in <a href="#eq-scenu">Equation&nbsp;<span>5.1</span></a> serve to convert between the units of the variable and utility. Specifically, the <span class="math inline">\beta_{mkt}</span> coefficient represents how many dollars of grocery cost a person is willing to spend to increase their utility by one unit.</p>
<p>In actuality, the utility formula in <a href="#eq-scenu">Equation&nbsp;<span>5.1</span></a> is a relative utility added by an unknown constant, <span class="math inline">U_{ij} = f(\mathbf{\beta}, X_{ij}) + C</span>, but this <span class="math inline">C</span> term is included in all the alternatives and therefore cancels out <span class="citation" data-cites="train2009">(<a href="references.html#ref-train2009" role="doc-biblioref">Train, 2009</a>)</span> in estimation. This means we cannot asses the <em>absolute</em> value of utility, but we can assess the <em>relative</em> monetary benefit of the difference between two scenarios as <span class="math display">
\mathrm{Benefit} = \sum_{i}\left(-\frac{\omega_i}{\beta_{mkt}}(CS_i^1 - CS_i^1)\right)
</span> where a weight <span class="math inline">\omega</span> accounts for the population in each origin zone <span class="math inline">i</span> and the <span class="math inline">\beta_{mkt}</span> converts the difference in utility into a dollar amount.</p>
<section id="scenario-descriptions" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="scenario-descriptions"><span class="header-section-number">5.1</span> Scenario Descriptions</h2>
<p>There are three general strategies we develop scenarios around:</p>
<ol type="1">
<li>Erect a new grocery store in the community, in a place where one does not already exist.</li>
<li>Improve an existing convenience store or dollar store so that it has the attributes of a full-service grocery store.</li>
<li>Improve the transit and non-motorized access to stores in a region.</li>
</ol>
<p>We implement all three strategies in scenarios on the west Salt Lake valley community. We also implement strategy 1 (a new store) in the San Juan and Utah County communities for comparison.</p>
<section id="erect-a-new-store" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="erect-a-new-store"><span class="header-section-number">5.1.1</span> Erect a new store</h3>
<p>This strategy assumes that the nutrition environment would benefit from a new store located in a place that presently has low grocery store access. To examine the potential for this strategy to improve access to nutrition in each community, we calculate the change in destination choice log-sum when a new store is added to the region in a location where access is currently poor. The new store is a full-service grocery store with a number of registers equal to the mean of other grocery stores in the community, and NEMS availability score, NEMS cost score, and market basket cost equivalent to the 75<span class="math inline">^{th}</span> percentile for the community. Thus the store is expected to be better-than-average quality as perceived by the residents of the community. The location for this new store is at 4100 S and 2700 W in West Valley City.</p>
</section>
<section id="improve-an-existing-store" class="level3" data-number="5.1.2">
<h3 data-number="5.1.2" class="anchored" data-anchor-id="improve-an-existing-store"><span class="header-section-number">5.1.2</span> Improve an existing store</h3>
<p>This strategy assumes that existing stores are in locations that the community values and can access, but that those stores may not have high availability of quality goods. To examine the potential for this strategy to improve access to nutrition, we improve the attributes of an existing dollar store in the community so that it has the size, prices, and availability of goods as a full-service grocery store. As above, we create a full-service grocery store with a number of registers equal to the mean of other grocery stores in the community, and NEMS availability score, NEMS cost score, and market basket cost equivalent to the 75<span class="math inline">^{th}</span> percentile for the community. Thus the store is expected to be better-than-average quality as perceived by the residents of the community; the difference from the previous scenario is that the improved store takes the place of an existing convenience store or dollar store.</p>
<p>The improved stores are at the following locations in each community:</p>
<ul>
<li>An ethnic store near 2700 W 3500 S in West Valley City (Salt Lake)</li>
<li>A small grocery store in Santaquin (Utah County)</li>
<li>A dollar store in Blanding (San Juan County)</li>
</ul>
</section>
<section id="improve-transit-and-non-motorized-transport" class="level3" data-number="5.1.3">
<h3 data-number="5.1.3" class="anchored" data-anchor-id="improve-transit-and-non-motorized-transport"><span class="header-section-number">5.1.3</span> Improve transit and non-motorized transport</h3>
<p>This strategy assumes that people cannot easily travel to existing stores because they cannot or do not drive for a variety of reasons, and that the public and and active transport networks provide an insufficient level of service. To examine the potential for this strategy to improve access to nutrition, we improve the travel time costs in the Salt Lake community for non-motorized and public transportation in the region and calculate the change in destination choice log-sum.</p>
<p>For active transportation, the lack of pedestrian facilities across and alongside roads both in reality and in the OpenStreetMap dataset may substantially increase measured walk distances and times. In this scenario, we replace the times measured from OpenStreetMap using R5 with an idealized Euclidean distance function, <span id="eq-newwalk"><span class="math display">
t_{\mathrm{walk}} = \frac{\sqrt{2} * d'_{ij}}{v_{\mathrm{walk}}}
\tag{5.2}</span></span> where <span class="math inline">d'_{ij}</span> is the Euclidean (straight-line) distance between <span class="math inline">i</span> and <span class="math inline">j</span> and <span class="math inline">v_{ij}</span> is an average walking speed equivalent to 3.5 feet per second <span class="citation" data-cites="fitzpatrick2006">(<a href="references.html#ref-fitzpatrick2006" role="doc-biblioref">Fitzpatrick et al., 2006</a>)</span>. The distance is multiplied by the square root of 2 to reflect the Manhattan distance (along a gridded street system). We retain the cap on walking distance at 10 kilometers. Though this distance may radically understate the real walking distance, we are trying to create an idealized scenario of effectively frictionless active transport. For public transit, we assume that the frequency of service is such that all transfer and initial wait times are at most 5 minutes, and that no person must walk more than 10 minutes to access their first public transport service.</p>
<p>Travel times are improved in this way for all block group — store pairs in the west Salt Lake Valley community.</p>
</section>
</section>
<section id="scenario-results" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="scenario-results"><span class="header-section-number">5.2</span> Scenario Results</h2>
<div class="cell" data-hash="05_scenarios_cache/html/loadbase_087618fa4f7bd6aa0bc3536113d84cf9">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(bg)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(bg_acs)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>sl_base <span class="ot">&lt;-</span> <span class="fu">tar_read</span>(sl_access)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(mkt_betas)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Using the methodology described above, we recalculated the destination choice log-sum value for each block group under each scenario, and compared the change in accessibility resulting from the improvement.</p>
<div class="cell" data-hash="05_scenarios_cache/html/fig-s1results_bdcfd89259893429c9f85548fda056b9">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>s1_altd <span class="ot">&lt;-</span> <span class="fu">tar_read</span>(s1_access)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>s1cost <span class="ot">&lt;-</span> bg <span class="sc">|&gt;</span>  <span class="fu">select</span>(<span class="at">id =</span> GEOID) <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">substr</span>(id, <span class="dv">3</span>, <span class="dv">5</span>) <span class="sc">==</span> <span class="st">"035"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(bg_acs, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"geoid"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(<span class="dv">4326</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sl_base <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">base =</span> dclogsum)) <span class="sc">|&gt;</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(s1_altd <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">alt =</span> dclogsum)) <span class="sc">|&gt;</span> </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> (base <span class="sc">-</span> alt) <span class="sc">/</span> mkt_betas[<span class="st">"SaltLake.market"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(id)`
Joining with `by = join_by(id)`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> wesanderson<span class="sc">::</span><span class="fu">wes_palette</span>(<span class="st">"Zissou1"</span>, <span class="dv">100</span>, <span class="at">type =</span> <span class="st">"continuous"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(s1cost, <span class="fu">aes</span>(<span class="at">fill =</span> diff)) <span class="sc">+</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  ggspatial<span class="sc">::</span><span class="fu">annotation_map_tile</span>(<span class="at">type =</span> <span class="st">"cartolight"</span>, <span class="at">zoom =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">lwd =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">112.11</span>, <span class="sc">-</span><span class="fl">111.7</span>)) <span class="sc">+</span> </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">40.5</span>, <span class="fl">40.8</span>)) <span class="sc">+</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="st">"Benefit [$]"</span>, <span class="at">colours =</span> pal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required namespace: raster
The legacy packages maptools, rgdal, and rgeos, underpinning the sp package,
which was just loaded, will retire in October 2023.
Please refer to R-spatial evolution reports for details, especially
https://r-spatial.org/r/2023/05/15/evolution4.html.
It may be desirable to make the sf package available;
package maintainers should consider adding sf to Suggests:.
The sp package is now running under evolution status 2
     (status 2 uses the sf package in place of rgdal)
Please note that rgdal will be retired during October 2023,
plan transition to sf/stars/terra functions using GDAL and PROJ
at your earliest convenience.
See https://r-spatial.org/r/2023/05/15/evolution4.html and https://github.com/r-spatial/evolution
rgdal: version: 1.6-7, (SVN revision 1203)
Geospatial Data Abstraction Library extensions to R successfully loaded
Loaded GDAL runtime: GDAL 3.5.3, released 2022/10/21
Path to GDAL shared files: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/library/rgdal/gdal
 GDAL does not use iconv for recoding strings.
GDAL binary built with GEOS: TRUE 
Loaded PROJ runtime: Rel. 9.1.0, September 1st, 2022, [PJ_VERSION: 910]
Path to PROJ shared files: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/library/rgdal/proj
PROJ CDN enabled: FALSE
Linking to sp version:1.6-1
To mute warnings of possible GDAL/OSR exportToProj4() degradation,
use options("rgdal_show_exportToProj4_warnings"="none") before loading sp or rgdal.
Zoom: 12</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-s1results" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="05_scenarios_files/figure-html/fig-s1results-1.png" class="img-fluid figure-img" style="width:6in"></p>
<figcaption class="figure-caption">Figure&nbsp;5.1: Estimated per-household benefits of adding new full-service store in west Salt Lake Valley</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-s1results">Figure&nbsp;<span>5.1</span></a> shows the geographic distribution of benefits associated with locating a new store at a site in the Salt Lake community. The benefits are largest immediately next to the new store, where they exceed <span class="math inline">1</span> for each household each time the household makes a trip to a grocery store.</p>
<div class="cell" data-hash="05_scenarios_cache/html/fig-s2results_00cfa016d40348f03b78900f4aaa8717">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>s2_altd <span class="ot">&lt;-</span> <span class="fu">tar_read</span>(s2_access)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>s2cost <span class="ot">&lt;-</span> bg <span class="sc">|&gt;</span>  <span class="fu">select</span>(<span class="at">id =</span> GEOID) <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">substr</span>(id, <span class="dv">3</span>, <span class="dv">5</span>) <span class="sc">==</span> <span class="st">"035"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(bg_acs, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"geoid"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(<span class="dv">4326</span>) <span class="sc">|&gt;</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sl_base <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">base =</span> dclogsum)) <span class="sc">|&gt;</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(s2_altd <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">alt =</span> dclogsum)) <span class="sc">|&gt;</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> (base <span class="sc">-</span> alt) <span class="sc">/</span> mkt_betas[<span class="st">"SaltLake.market"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(id)`
Joining with `by = join_by(id)`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> wesanderson<span class="sc">::</span><span class="fu">wes_palette</span>(<span class="st">"Zissou1"</span>, <span class="dv">100</span>, <span class="at">type =</span> <span class="st">"continuous"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(s2cost, <span class="fu">aes</span>(<span class="at">fill =</span> diff)) <span class="sc">+</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  ggspatial<span class="sc">::</span><span class="fu">annotation_map_tile</span>(<span class="at">type =</span> <span class="st">"cartolight"</span>, <span class="at">zoom =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">lwd =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">112.11</span>, <span class="sc">-</span><span class="fl">111.7</span>)) <span class="sc">+</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">40.5</span>, <span class="fl">40.8</span>)) <span class="sc">+</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="st">"Benefit [$]"</span>, <span class="at">colours =</span> pal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Zoom: 12</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-s2results" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="05_scenarios_files/figure-html/fig-s2results-1.png" class="img-fluid figure-img" style="width:6in"></p>
<figcaption class="figure-caption">Figure&nbsp;5.2: Estimated per-household benefits of improving an existing store in west Salt Lake Valley</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-s2results">Figure&nbsp;<span>5.2</span></a> shows the results of the scenario improving an existing store in the Salt Lake community. Compared to the results of the new store scenario, the scale of the benefits are not as substantial (a maximum per-household-trip benefit of less than $1), and seem to not cover quite as large a geographic region. <a href="#fig-s2sjut">Figure&nbsp;<span>5.3</span></a> shows the results of improving a store in Utah and San Juan Counties. As in Salt Lake, the benefits are most strongly concentrated in the immediate vicinity of the improved store. One interesting observation — especially in Utah County — is that the improvements are felt more strongly in the block groups near the improved store that have lower availability of other options. The block group in Utah County directly containing the improvement sees a per-household-trip benefit well over $2, considerably more than the maximum benefit in Salt Lake. This is intuitive, as the improvement of a store matters less if the stores close to you are already sufficient.</p>
<div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(wf_access)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(ru_access)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(s2_access_ut)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(s2_access_sj)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> wesanderson<span class="sc">::</span><span class="fu">wes_palette</span>(<span class="st">"Zissou1"</span>, <span class="dv">100</span>, <span class="at">type =</span> <span class="st">"continuous"</span>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>s2cost_ut <span class="ot">&lt;-</span> bg <span class="sc">|&gt;</span>  <span class="fu">select</span>(<span class="at">id =</span> GEOID) <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">substr</span>(id, <span class="dv">3</span>, <span class="dv">5</span>) <span class="sc">==</span> <span class="st">"049"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(bg_acs, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"geoid"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(<span class="dv">4326</span>) <span class="sc">|&gt;</span> </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(wf_access <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">base =</span> dclogsum)) <span class="sc">|&gt;</span> </span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(s2_access_ut <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">alt =</span> dclogsum)) <span class="sc">|&gt;</span> </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> (base <span class="sc">-</span> alt) <span class="sc">/</span> mkt_betas[<span class="st">"Utah.market"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(id)`
Joining with `by = join_by(id)`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(s2cost_ut, <span class="fu">aes</span>(<span class="at">fill =</span> diff)) <span class="sc">+</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  ggspatial<span class="sc">::</span><span class="fu">annotation_map_tile</span>(<span class="at">type =</span> <span class="st">"cartolight"</span>, <span class="at">zoom =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">112.1</span>, <span class="sc">-</span><span class="fl">111.5</span>)) <span class="sc">+</span> </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">39.9</span>, <span class="fl">40.48</span>)) <span class="sc">+</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">lwd =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="st">"Benefit [$]"</span>, <span class="at">colours =</span> pal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Zoom: 12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>s2cost_sj <span class="ot">&lt;-</span> bg <span class="sc">|&gt;</span>  <span class="fu">select</span>(<span class="at">id =</span> GEOID) <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">substr</span>(id, <span class="dv">3</span>, <span class="dv">5</span>) <span class="sc">==</span> <span class="st">"037"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(bg_acs, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"geoid"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(<span class="dv">4326</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(ru_access <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">base =</span> dclogsum)) <span class="sc">|&gt;</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(s2_access_sj <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">alt =</span> dclogsum)) <span class="sc">|&gt;</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> (base <span class="sc">-</span> alt) <span class="sc">/</span> mkt_betas[<span class="st">"SanJuan.market"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(id)`
Joining with `by = join_by(id)`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(s2cost_sj, <span class="fu">aes</span>(<span class="at">fill =</span> diff)) <span class="sc">+</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  ggspatial<span class="sc">::</span><span class="fu">annotation_map_tile</span>(<span class="at">type =</span> <span class="st">"cartolight"</span>, <span class="at">zoom =</span> <span class="dv">10</span>) <span class="sc">+</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">lwd =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="st">"Benefit [$]"</span>, <span class="at">colours =</span> pal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Zoom: 10</code></pre>
</div>
<div id="fig-s2sjut" class="cell quarto-layout-panel" data-hash="05_scenarios_cache/html/fig-s2sjut_2c6e356e722100a9383615e0f3bc2f1a">
<figure class="figure">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-s2sjut-1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="05_scenarios_files/figure-html/fig-s2sjut-1.png" class="img-fluid figure-img" style="width:4in" data-ref-parent="fig-s2sjut"></p>
<figcaption class="figure-caption">(a) Utah County (in Santaquin)</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell quarto-layout-cell-subref" style="flex-basis: 50.0%;justify-content: center;">
<div id="fig-s2sjut-2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="05_scenarios_files/figure-html/fig-s2sjut-2.png" class="img-fluid figure-img" style="width:4in" data-ref-parent="fig-s2sjut"></p>
<figcaption class="figure-caption">(b) San Juan County (in Blanding)</figcaption>
</figure>
</div>
</div>
</div>
<p></p><figcaption class="figure-caption">Figure&nbsp;5.3: Estimated per-household benefits of improving an existing store in Utah and San Juan Counties.</figcaption><p></p>
</figure>
</div>
</div>
<p>The results of the third scenario, improving the access of non-motorized and public transit access to stores, are shown in <a href="#fig-s3results">Figure&nbsp;<span>5.4</span></a>. This benefit is spread over a larger area, and is concentrated on the 35 MAX bus rapid transit corridor where the improvement in walk access time to transit couples with high frequency transit service to large grocery stores on the corridor. The per-household-trip benefit is very small however, with a maximum benefit on the order of $0.25.</p>
<div class="cell" data-hash="05_scenarios_cache/html/fig-s3results_ca8371216aad80ec315a746313dea5fd">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>s3_altd <span class="ot">&lt;-</span> <span class="fu">tar_read</span>(s3_access)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>s3cost <span class="ot">&lt;-</span> bg <span class="sc">|&gt;</span>  <span class="fu">select</span>(<span class="at">id =</span> GEOID) <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="fu">substr</span>(id, <span class="dv">3</span>, <span class="dv">5</span>) <span class="sc">==</span> <span class="st">"035"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(bg_acs, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"id"</span> <span class="ot">=</span> <span class="st">"geoid"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_transform</span>(<span class="dv">4326</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sl_base <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">base =</span> dclogsum)) <span class="sc">|&gt;</span> </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(s3_altd <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">alt =</span> dclogsum)) <span class="sc">|&gt;</span> </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">diff =</span> (base <span class="sc">-</span> alt) <span class="sc">/</span> mkt_betas[<span class="st">"SaltLake.market"</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(id)`
Joining with `by = join_by(id)`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>pal <span class="ot">&lt;-</span> wesanderson<span class="sc">::</span><span class="fu">wes_palette</span>(<span class="st">"Zissou1"</span>, <span class="dv">100</span>, <span class="at">type =</span> <span class="st">"continuous"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(s3cost, <span class="fu">aes</span>(<span class="at">fill =</span> diff)) <span class="sc">+</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  ggspatial<span class="sc">::</span><span class="fu">annotation_map_tile</span>(<span class="at">type =</span> <span class="st">"cartolight"</span>, <span class="at">zoom =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">lwd =</span> <span class="dv">0</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">112.11</span>, <span class="sc">-</span><span class="fl">111.7</span>)) <span class="sc">+</span> </span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="fl">40.5</span>, <span class="fl">40.8</span>)) <span class="sc">+</span> </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.x =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.ticks.y =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradientn</span>(<span class="st">"Benefit [$]"</span>, <span class="at">colours =</span> pal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Zoom: 12</code></pre>
</div>
<div class="cell-output-display">
<div id="fig-s3results" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="05_scenarios_files/figure-html/fig-s3results-1.png" class="img-fluid figure-img" style="width:6in"></p>
<figcaption class="figure-caption">Figure&nbsp;5.4: Estimated per-household benefits of improving non-motorized and public transport access to groceries in Salt Lake Valley.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-hash="05_scenarios_cache/html/tbl-scenarios_b3e14dcf727901caf1a4141f994ce667">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="st">"New Store"</span> <span class="ot">=</span> s1cost,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Salt Lake Valley"</span> <span class="ot">=</span> s2cost,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Utah County"</span> <span class="ot">=</span> s2cost_ut,</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"San Juan County"</span> <span class="ot">=</span> s2cost_sj,</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Improved Transport"</span> <span class="ot">=</span> s3cost</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="at">.id =</span> <span class="st">"Scenario"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  sf<span class="sc">::</span><span class="fu">st_set_geometry</span>(<span class="cn">NULL</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">hh =</span> households <span class="sc">*</span> diff,</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">nw =</span> (<span class="dv">100</span> <span class="sc">-</span> white)<span class="sc">/</span><span class="dv">100</span> <span class="sc">*</span> households <span class="sc">*</span> diff,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">li =</span> households <span class="sc">*</span> lowincome<span class="sc">/</span><span class="dv">100</span> <span class="sc">*</span> diff</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">across</span>(hh<span class="sc">:</span>li, <span class="sc">~</span>scales<span class="sc">::</span><span class="fu">dollar</span>(<span class="fu">sum</span>(.x, <span class="at">na.rm =</span> <span class="cn">TRUE</span>) <span class="sc">/</span> mkt_betas[<span class="st">"SaltLake.market"</span>] <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span>)),</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">.by =</span> Scenario</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span>knitr<span class="sc">::</span><span class="fu">pandoc_to</span>(<span class="st">"docx"</span>)){</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(df, <span class="at">booktabs =</span> <span class="cn">TRUE</span>, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Scenario"</span>, <span class="st">"Households"</span>, <span class="st">"Non-white"</span>, <span class="st">"Low-Income"</span>),</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">digits =</span> <span class="dv">0</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Weighted by"</span> <span class="ot">=</span> <span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_rows</span>(<span class="at">group_label =</span> <span class="st">"Improved Store"</span>, <span class="at">start_row =</span> <span class="dv">2</span>, <span class="at">end_row =</span> <span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-scenarios" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;5.1: Scenario Benefits</caption>
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Weighted by
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Scenario</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Households</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Non-white</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Low-Income</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">New Store</td>
<td style="text-align: left;">$5,538,988</td>
<td style="text-align: left;">$2,449,404</td>
<td style="text-align: left;">$961,684</td>
</tr>
<tr class="even" data-grouplength="3">
<td colspan="4" style="text-align: left; border-bottom: 1px solid;"><strong>Improved Store</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Salt Lake Valley</td>
<td style="text-align: left;">$2,849,176</td>
<td style="text-align: left;">$1,364,404</td>
<td style="text-align: left;">$569,364</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Utah County</td>
<td style="text-align: left;">$1,516,458</td>
<td style="text-align: left;">$245,638</td>
<td style="text-align: left;">$233,778</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">San Juan County</td>
<td style="text-align: left;">$52,152.69</td>
<td style="text-align: left;">$26,914.35</td>
<td style="text-align: left;">$18,280.71</td>
</tr>
<tr class="even">
<td style="text-align: left;">Improved Transport</td>
<td style="text-align: left;">$872,015</td>
<td style="text-align: left;">$393,554</td>
<td style="text-align: left;">$120,078</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Although comparing the geographic distribution of benefits is helpful, the aggregate benefit is more likely to guide policy. Additionally, the aggregate benefits can be weighted in different ways to understand the effects of the various policies on different populations. <a href="#tbl-scenarios">Table&nbsp;<span>5.1</span></a> presents the aggregate benefit from each of the three scenarios (and the result of the second scenario in all three communities). The Households column multiplies the difference in destination choice log-sum at each block group by the number of households in that block group, while the non-white and low-income columns weight the difference by the share of non-white individuals and low-income households respectively. All demographic data comes from the American Community Survey 5-year aggregations.</p>
<p>These alternate weighting schemes help to illustrate the potential equity of the benefit distribution should each scenario be pursued. The new store scenario in the Salt Lake community, for example, has a total benefit of approximately $5.5 million. Of this amount, somewhat less than half the benefits go to non-white individuals and less than one-fifth to low-income households. These ratios are more or less the same for the store improvement scenario and the improved transport scenario in the Salt Lake Valley. The Utah County store improvement, on the other hand, has a somewhat higher proportion of benefits going to low-income households relative to non-white households. This is a reflection of the lower minority population in southern Utah County vis a vis west Salt Lake valley, but is nonetheless a metric that program evaluators might pay attention to.</p>
<p>Overall, the improved store brings more than twice the benefits of improving non-automobile transportation, and the new store more than five times the benefits. Understanding the costs of these various alternatives is outside the scope of this research, but the level of infrastructure investment required to increase transportation level of service to that constructed in the simulation is likely an order of magnitude higher than the cost of a single new grocery store. It should also be acknowledged that improving non-automobile infrastructure and services would have benefits beyond just grocery store trips that we do not attempt to enumerate here. It is also not clear whether the level of improvement simulated in the second scenario could be accomplished within the envelope of the existing store; it may be that such improvements would meet or exceed the cost of building a new store on a new site, along with stocking, staffing, and operating the store.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list" style="display: none">
<div id="ref-ben-akiva1985" class="csl-entry" role="listitem">
Ben-Akiva, M., &amp; Lerman, S. R. (1985). <em>Discrete <span>Choice Analysis</span>: <span>Theory</span> and <span>Applications</span> to <span>Travel Demand</span></em>. <span>MIT Press</span>. <a href="https://www.jstor.org/stable/1391567">https://www.jstor.org/stable/1391567</a>
</div>
<div id="ref-fitzpatrick2006" class="csl-entry" role="listitem">
Fitzpatrick, K., Brewer, M. A., &amp; Turner, S. (2006). Another <span>Look</span> at <span>Pedestrian Walking Speed</span>. <em>Transportation Research Record</em>, <em>1982</em>(1), 21–29. <a href="https://doi.org/10.1177/0361198106198200104">https://doi.org/10.1177/0361198106198200104</a>
</div>
<div id="ref-train2009" class="csl-entry" role="listitem">
Train, K. E. (2009). <em>Discrete <span>Choice Methods</span> with <span>Simulation</span></em> (2nd edition). <span>Cambridge University Press</span>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./04_estimation.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Results</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06_conclusion.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Conclusions and Recommendations</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>