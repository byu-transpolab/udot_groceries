<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="keywords" content="Accessibility, Access to nutrition, Passive location data">

<title>Equitable Access to Nutrition in Utah - 3&nbsp; Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04_estimation.html" rel="next">
<link href="./02_litreview.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

</head>

<body class="nav-sidebar floating">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03_methods.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Methods</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Equitable Access to Nutrition in Utah</a> 
        <div class="sidebar-tools-main">
    <a href="./Equitable-Access-to-Nutrition-in-Utah.pdf" rel="" title="Download PDF" class="quarto-navigation-tool px-1" aria-label="Download PDF"><i class="bi bi-file-pdf"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_litreview.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Literature Review</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_methods.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Methods</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_estimation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Results</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_scenarios.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Application</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06_conclusion.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Conclusions and Recommendations</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./acknowledgments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Acknowledgments</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#model" id="toc-model" class="nav-link active" data-scroll-target="#model"><span class="header-section-number">3.1</span> Model</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">3.2</span> Data</a>
  <ul class="collapse">
  <li><a href="#store-attributes" id="toc-store-attributes" class="nav-link" data-scroll-target="#store-attributes"><span class="header-section-number">3.2.1</span> Store Attributes</a></li>
  <li><a href="#imputation-of-missing-store-data" id="toc-imputation-of-missing-store-data" class="nav-link" data-scroll-target="#imputation-of-missing-store-data"><span class="header-section-number">3.2.2</span> Imputation of Missing Store Data</a></li>
  <li><a href="#sec-mcls" id="toc-sec-mcls" class="nav-link" data-scroll-target="#sec-mcls"><span class="header-section-number">3.2.3</span> Travel Impedances</a></li>
  <li><a href="#mobile-device-data" id="toc-mobile-device-data" class="nav-link" data-scroll-target="#mobile-device-data"><span class="header-section-number">3.2.4</span> Mobile Device Data</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-methods" class="quarto-section-identifier"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Methods</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This section describes how we construct a model of access to grocery stores in communities in Utah. We first describe the theoretical model, and then describe data collection efforts to estimate this model and apply it.</p>
<section id="model" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="model"><span class="header-section-number">3.1</span> Model</h2>
<p>A typical model of destination choice <span class="citation" data-cites="recker1978">(<a href="references.html#ref-recker1978" role="doc-biblioref">Recker &amp; Kostyniuk, 1978</a>)</span> can be described as a random utility maximization model where the utility of an individual <span class="math inline">i</span> choosing a particular destination <span class="math inline">j</span> is <span id="eq-utility"><span class="math display"> U_{ij} = \beta_{s}f(k_{ij}) + \beta_{x}(X_j)  \tag{3.1}</span></span> where <span class="math inline">f(k_{ij})</span> is a function of the travel impedance or costs from <span class="math inline">i</span> to <span class="math inline">j</span> and <span class="math inline">X_{j}</span> represents the location attributes of <span class="math inline">j</span>. The coefficients <span class="math inline">\beta</span> can be estimated given sufficient data revealing the choices of individuals. The probability that individual at location <span class="math inline">i</span> will choose alternative <span class="math inline">j</span> from a choice set <span class="math inline">J</span> can be estimated with a multinomial logit model (MNL) <span class="citation" data-cites="mcfadden1974">(<a href="references.html#ref-mcfadden1974" role="doc-biblioref">McFadden, 1974</a>)</span>, <span id="eq-mnl"><span class="math display"> P_i(j) = \frac{\exp(U_{ij})}{\sum_{j' \in J}{\exp(U_{ij'})}} \tag{3.2}</span></span> The overall fit of the model can be described with the Akaike Information Criterion (AIC) — which should be minimized — or by the McFadden likelihood ratio <span class="math inline">\rho^2_0 = 1 - \ln\mathcal{L} / \ln\mathcal{L}_0</span>. In this ratio <span class="math inline">\ln{\mathcal{L}}</span> is the model log-likelihood and <span class="math inline">\ln{\mathcal{L}_0}</span> the log-likelihood of an alternative model where all destinations are equally likely; a higher <span class="math inline">\rho^2_0</span> value indicates more explanatory power relative to this null, random chance only model.</p>
<p>The idea of using destination choice logsums as accessibility terms is not new, and the theory for doing so is described in <span class="citation" data-cites="ben-akiva1985">Ben-Akiva &amp; Lerman (<a href="references.html#ref-ben-akiva1985" role="doc-biblioref">1985, p. 301</a>)</span>. Effectively, the natural logarithm of the denominator in <a href="#eq-mnl">Equation&nbsp;<span>3.2</span></a> represents the consumer surplus — or total benefit — available to person <span class="math inline">i</span>:</p>
<p><span id="eq-cs"><span class="math display"> CS_i = \ln\left(\sum_{j \in J} \exp(U_{ij})\right) \tag{3.3}</span></span></p>
<p>A difference in logsum measures may exist for a number of reasons that affect the utility functions described in <a href="#eq-utility">Equation&nbsp;<span>3.1</span></a>. For example, individuals at different locations or with different mobility will see different impedance values <span class="math inline">k_{ij}</span> and therefore affected utility. Changes to the attributes of the destinations <span class="math inline">X_j</span> will likewise affect the utility.</p>
<p>Despite the relative maturity of this theory, applications of utility-based access in the literature are still rare, outside of public transport forecasting analyses <span class="citation" data-cites="geurs2010">(<a href="references.html#ref-geurs2010" role="doc-biblioref">Geurs et al., 2010</a>)</span>. The rarity is likely explained by an unfamiliarity with destination choice models and the ready availability of simpler methods on one hand <span class="citation" data-cites="logan2019">(<a href="references.html#ref-logan2019" role="doc-biblioref">Logan et al., 2019</a>)</span>, and the difficulty in obtaining a suitable estimation dataset for particular land uses on the other <span class="citation" data-cites="kaczynski2016">(<a href="references.html#ref-kaczynski2016" role="doc-biblioref">Kaczynski et al., 2016</a>)</span>. This second limitation has been somewhat improved by a new methodology developed by <span class="citation" data-cites="macfarlane2022a">Macfarlane et al. (<a href="references.html#ref-macfarlane2022a" role="doc-biblioref">2022</a>)</span> , relying on commercial location-based services data to estimate the affinity for simulated agents to visit destinations of varying attributes and distances.</p>
</section>
<section id="data" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="data"><span class="header-section-number">3.2</span> Data</h2>
<p>In this research, we develop a unique dataset to estimate the destination choice utility coefficients for grocery store choice in three different communities in Utah. The three communities were selected to maximize potential observed differences in utility between community residents. The three communities are Utah County, West Salt Lake Valley, and San Juan County. Note that in this document we refer to the second community as “Salt Lake” even though this does not refer to the entire Salt Lake County nor to Salt Lake City, rather, we focus on communities in the western part of the valley, such as Magna, Kearns, and West Valley City.</p>
<p><a href="#tbl-acsdata">Table&nbsp;<span>3.1</span></a> shows several key population statistics based on 2021 American Community Survey data for block groups in the three communities of interest. Utah County is a largely suburban county with high incomes and a low percentage of minority individuals. The Salt Lake region is more dense with somewhat lower incomes and household sizes but a high share of minority individuals. San Juan County is primarily rural, with a few small communities and a large reservation for the Navajo Tribe.</p>
<div class="cell" data-hash="03_methods_cache/html/tbl-acsdata_41f8ebd4ebd4c2b0666dbcd750096c09">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(neighbor_acs) </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> neighbor_acs <span class="sc">|&gt;</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">county =</span> <span class="fu">relevel</span>(<span class="fu">factor</span>(county), <span class="at">ref =</span> <span class="st">"Utah"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(county) <span class="sc">|&gt;</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Total population</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(population),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Total households</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">sum</span>(households),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Housing units per sq. km</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">weighted.mean</span>(density, housing_units),</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Median income</span><span class="st">`</span> <span class="ot">=</span> Hmisc<span class="sc">::</span><span class="fu">wtd.quantile</span>(income, <span class="at">weights =</span> households, <span class="at">probs =</span> .<span class="dv">5</span>),</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">`</span><span class="at">Percent minority individuals</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">weighted.mean</span>(<span class="dv">100</span> <span class="sc">-</span> white, population)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  data.table<span class="sc">::</span><span class="fu">transpose</span>(<span class="at">make.names =</span> <span class="st">'county'</span>, <span class="at">keep.names =</span> <span class="st">'measure'</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span>knitr<span class="sc">::</span><span class="fu">pandoc_to</span>(<span class="st">"docx"</span>)){</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kbl</span>(df, <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"Utah"</span>, <span class="st">"Salt Lake"</span>, <span class="st">"San Juan"</span>), <span class="at">digits =</span> <span class="dv">0</span>, </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">format.args =</span> <span class="fu">list</span>(<span class="at">big.mark =</span> <span class="st">','</span>), <span class="at">booktabs =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>()</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="tbl-acsdata" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;3.1: Demographic Statistics of Study Region</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Utah</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Salt Lake</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">San Juan</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Total population</td>
<td style="text-align: right;">627,098</td>
<td style="text-align: right;">655,830</td>
<td style="text-align: right;">7,091</td>
</tr>
<tr class="even">
<td style="text-align: left;">Total households</td>
<td style="text-align: right;">171,538</td>
<td style="text-align: right;">216,731</td>
<td style="text-align: right;">2,090</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Housing units per sq. km</td>
<td style="text-align: right;">599</td>
<td style="text-align: right;">831</td>
<td style="text-align: right;">103</td>
</tr>
<tr class="even">
<td style="text-align: left;">Median income</td>
<td style="text-align: right;">79,453</td>
<td style="text-align: right;">64,868</td>
<td style="text-align: right;">58,586</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Percent minority individuals</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">26</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>Estimating the utility model described in <a href="#eq-mnl">Equation&nbsp;<span>3.2</span></a> for grocery stores requires three interrelated data elements:</p>
<ol type="1">
<li>an inventory of grocery store attributes <span class="math inline">X_j</span>,</li>
<li>a representative travel impedance matrix <span class="math inline">K</span> composed of all combinations of origin <span class="math inline">i</span> and destination <span class="math inline">j</span>.</li>
<li>a database of observed person flows between <span class="math inline">i</span> and <span class="math inline">j</span> by which to estimate the <span class="math inline">\beta</span> coefficients.</li>
</ol>
<p>We describe each of these elements in turn in the following sections.</p>
<section id="store-attributes" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="store-attributes"><span class="header-section-number">3.2.1</span> Store Attributes</h3>
<div class="cell" data-hash="03_methods_cache/html/nems_f5b7cc204f62e409e019561c88fa3e0d">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(nems_groceries)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The store attributes were collected using the Nutritional Environment Measures Survey — Stores (NEMS-S) tool <span class="citation" data-cites="glanz2007">(<a href="references.html#ref-glanz2007" role="doc-biblioref">Glanz et al., 2007</a>)</span>. This tool was developed to reveal significant differences in the availability and cost of healthy foods in an environment, and has been validated for this purpose. Beyond superficial attributes such as the store category (dollar store, convenience store, ethnic market, etc.) and the number of registers, the NEMS-S collects detailed information about numerous store offerings such as the availability of produce, dairy products, lean meats, juices, and canned and dry goods of various specific types. Of particular interest to the survey are availability and price differentials of lower-fat alternatives: for example, the survey instrument requests the shelf space allocated to milk products of various fat levels and the price of each product.</p>
<p>Student research assistants collected the store attributes by visiting grocery stores, dollar stores, ethnic markets, and other food markets in the three communities of interest described above. Stores were identified using internet-based maps combined with in-person validation and observation. The student researchers completed the NEMS-S instrument with the aid of a digital survey and a tablet computer. Each researcher who collected data was trained to use the survey at a control store in Provo, and the training data helped to eliminate the risk of surveyor bias. The store attributes were collected in the spring of 2021 for Utah County and spring of 2022 for Salt Lake and San Juan Counties. In Utah and Salt Lake Counties, we included dollar stores and grocery stores but did not include convenience stores. Given the rural nature of San Juan County, we made two adjustments to capture the entirety of the nutrition environment. First, we included convenience stores and trading posts if they were the only food market in a community. We also included full-service grocery stores in Cortez, Colorado, and Farmington, New Mexico in the San Juan data collection, as community conversations made it clear that many residents will drive these long distances for periodic shopping with greater availability and lower prices.</p>
<p>Using the information in the NEMS-S survey, two measures of a store can be calculated: an availability score based on whether stores stock particular items as well as lower-calorie options; and a cost score describing the spread between prices of these options. These score values are described in <span class="citation" data-cites="lunsford2021">Lunsford et al. (<a href="references.html#ref-lunsford2021" role="doc-biblioref">2021</a>)</span>, and we developed an R package to compute the scores; this package is available at <a href="https://github.com/byu-transpolab/nemsr" class="uri">https://github.com/byu-transpolab/nemsr</a>. In the availability score each store is given a value for whether or not there are more healthful options available in the store, such as low-calorie chips, or low-fat milk. If the store does not have a more healthful option in a category it receives a lower score, so stores with more availability of healthful food options will receive a higher availability score. For the cost score, the measure is the price spread between healthful and less healful options: if the price of whole wheat bread is cheaper than white bread, the store receives positive points for the cost option, if the price is the same then zero points are awarded, and if the wheat bread is more expensive then the store receives negative points. Thus a store with a higher availability and cost score will have both more healthful options, and a more advantageous pricing scheme towards those options.</p>
<p>One important store attribute that the NEMS-S instrument does not collect or compute directly is a measure of the cost of common goods that can be compared across stores. We therefore used the data collected from the NEMS-S instrument to construct a market basket-based affordability measure that could be compared across stores, following the approach of <span class="citation" data-cites="hedrick2022">Hedrick et al. (<a href="references.html#ref-hedrick2022" role="doc-biblioref">2022</a>)</span>. This market basket score is based on the US Department of Agriculture (USDA) 2021 Thrifty Food Plan <span class="citation" data-cites="fns2021">(<a href="references.html#ref-fns2021" role="doc-biblioref">FNS, 2021</a>)</span>, which calculates a reference market basket for a family of four. Because this market basket contains more (and sometimes different) items than what the NEMS-S instrument requests, we chose relevant items from our NEMS-S data as replacements. For example, the USDA market basket contains a certain amount of poultry, but the NEMS-S score collects the per-pound cost of ground beef at various fat contents. For any stores that were missing any of the elements in the market basket, we first substituted with another ingredient that would fit the nutritional requirements. If no substitute was available, we included the average price of the missing good at other stores in that community multiplied by 1.5 as a penalty for not containing the product. The final market basket score is the total cost of all foods in the market basket. These costs can then be compared from store to store to understand general affordability comparisons between stores.</p>
<div class="cell" data-hash="03_methods_cache/html/tbl-nems_4a9cd1e72aa72aa9f50323dc4d3989cb">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(nems_groceries)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>balnems <span class="ot">&lt;-</span> nems_groceries <span class="sc">|&gt;</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">Type =</span> <span class="fu">ifelse</span>(type <span class="sc">==</span> <span class="st">"Trading Post"</span>, <span class="st">"Other"</span>, type),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">Pharmacy =</span> pharmacy, </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Ethnic market</span><span class="st">`</span> <span class="ot">=</span> ethnic,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Other merchandise sold</span><span class="st">`</span> <span class="ot">=</span> merch, </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Registers (incl. self checkout)</span><span class="st">`</span> <span class="ot">=</span> total_registers,  </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">NEMS-S availability score</span><span class="st">`</span> <span class="ot">=</span> availability, </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">NEMS-S cost score</span><span class="st">`</span> <span class="ot">=</span> cost, </span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Market basket cost</span><span class="st">`</span> <span class="ot">=</span> market, </span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">County =</span> <span class="fu">factor</span>(county, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Utah"</span>, <span class="st">"Salt Lake"</span>, <span class="st">"San Juan"</span>)))</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span>knitr<span class="sc">::</span><span class="fu">pandoc_to</span>(<span class="st">"docx"</span>)){</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">datasummary_balance</span>(<span class="sc">~</span>County, <span class="at">data =</span> balnems) <span class="sc">|&gt;</span> </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="st">"scale_down"</span>)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Please install the `estimatr` package or set `dinm=FALSE` to suppress
this warning.</code></pre>
</div>
<div class="cell-output-display">
<div id="tbl-nems" class="anchored">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<caption>Table&nbsp;3.2: Grocery Store Attributes</caption>
<colgroup>
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Utah (N=63)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Salt Lake (N=39)
</div></th>
<th colspan="2" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
San Juan (N=50)
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Dev.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Dev.</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Dev.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Registers (incl. self checkout)</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">12.5</td>
<td style="text-align: right;">11.7</td>
<td style="text-align: right;">9.9</td>
<td style="text-align: right;">8.9</td>
<td style="text-align: right;">6.1</td>
<td style="text-align: right;">8.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">NEMS-S availability score</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">18.7</td>
<td style="text-align: right;">8.4</td>
<td style="text-align: right;">16.2</td>
<td style="text-align: right;">8.1</td>
<td style="text-align: right;">13.2</td>
<td style="text-align: right;">7.6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">NEMS-S cost score</td>
<td style="text-align: left;"></td>
<td style="text-align: right;">1.9</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">2.3</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: right;">1.9</td>
</tr>
<tr class="even">
<td style="text-align: left; box-shadow: 0px 1.5px;">Market basket cost</td>
<td style="text-align: left; box-shadow: 0px 1.5px;"></td>
<td style="text-align: right; box-shadow: 0px 1.5px;">126.1</td>
<td style="text-align: right; box-shadow: 0px 1.5px;">21.5</td>
<td style="text-align: right; box-shadow: 0px 1.5px;">141.6</td>
<td style="text-align: right; box-shadow: 0px 1.5px;">19.2</td>
<td style="text-align: right; box-shadow: 0px 1.5px;">157.6</td>
<td style="text-align: right; box-shadow: 0px 1.5px;">16.8</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;"></td>
<td style="text-align: right;">N</td>
<td style="text-align: right;">Pct.</td>
<td style="text-align: right;">N</td>
<td style="text-align: right;">Pct.</td>
<td style="text-align: right;">N</td>
<td style="text-align: right;">Pct.</td>
</tr>
<tr class="even">
<td style="text-align: left;">Type</td>
<td style="text-align: left;">Convenience Store</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3.2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.0</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">20.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Dollar Store</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">7.9</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">28.2</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">30.0</td>
</tr>
<tr class="even">
<td style="text-align: left;"></td>
<td style="text-align: left;">Grocery Store</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">79.4</td>
<td style="text-align: right;">27</td>
<td style="text-align: right;">69.2</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">38.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">Other</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">9.5</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">12.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pharmacy</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">66.7</td>
<td style="text-align: right;">32</td>
<td style="text-align: right;">82.1</td>
<td style="text-align: right;">43</td>
<td style="text-align: right;">86.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">33.3</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">17.9</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">14.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ethnic market</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">87.3</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">76.9</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">94.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">12.7</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">23.1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">6.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Other merchandise sold</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">82.5</td>
<td style="text-align: right;">35</td>
<td style="text-align: right;">89.7</td>
<td style="text-align: right;">47</td>
<td style="text-align: right;">94.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;"></td>
<td style="text-align: left;">TRUE</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">17.5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">10.3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">6.0</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p><a href="#tbl-nems">Table&nbsp;<span>3.2</span></a> presents the store attribute data collected for each community. Utah County generally has the largest average store size (as measured by the number of checkout registers) while having the lowest market basket cost, the highest availability of health food (the NEMS-S availability score) and the lowest difference between healthy and unhealthy food (the NEMS-S cost score). San Juan County has the smallest average stores, highest costs and the lowest availability of healthy options, and Salt Lake falls in between.</p>
</section>
<section id="imputation-of-missing-store-data" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="imputation-of-missing-store-data"><span class="header-section-number">3.2.2</span> Imputation of Missing Store Data</h3>
<p>We collected detailed store attributes for stores in Utah County, San Juan County, and a portion of Salt Lake County using the NEMS-S survey instrument. These attributes form the basis of the choice models used to determine access, but understanding access in other parts of Salt Lake City or the state of Utah requires us to impute the attributes onto the stores that we did not collect.</p>
<p>To do this, we used web-based mapping databases (including OpenStreetMap and Google Maps) to obtain a list of grocery stores, dollar stores, and appropriate convenience stores throughout the state. From this search, we were able to determine each store’s location, brand name, and store type, which we also collected in the manual data assembly efforts. Using this information, we built a multiple imputation model using the <code>mice</code> package for R <span class="citation" data-cites="mice">(<a href="references.html#ref-mice" role="doc-biblioref">van Buuren &amp; Groothuis-Oudshoorn, 2011</a>)</span>. The predictor variables in the imputation included the store brand and type, as well as the average income and housing density in the nine closest block groups to the store location (based on population-weighted centroids).</p>
<div class="cell" data-hash="03_methods_cache/html/fig-marketimp_7c2b6cc9e3c72d4656d25aa575fe1447">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(imputed_groceries)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>combined <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="fu">seq_along</span>(imputed_groceries), </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                   <span class="cf">function</span>(i) mice<span class="sc">::</span><span class="fu">complete</span>(imputed_groceries, i)) <span class="sc">|&gt;</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_rows</span>(<span class="at">.id =</span> <span class="st">"imputation"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(type <span class="sc">==</span> <span class="st">"Grocery Store"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>()</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>sampled_store_ids <span class="ot">&lt;-</span> <span class="fu">sample</span>(combined<span class="sc">$</span>id, <span class="dv">15</span>)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>combined <span class="sc">|&gt;</span> </span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id <span class="sc">%in%</span> sampled_store_ids) <span class="sc">|&gt;</span> </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">grepl</span>(<span class="st">"SL|UT|SJ"</span>, id)) <span class="sc">|&gt;</span> </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(id) <span class="sc">|&gt;</span> </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> market)) <span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>id) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Imputed Market Basket Price [$]"</span>) <span class="sc">+</span> </span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-marketimp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="03_methods_files/figure-html/fig-marketimp-1.png" class="img-fluid figure-img" style="width:5in"></p>
<figcaption class="figure-caption">Figure&nbsp;3.1: Imputed market price values for 15 random grocery stores.</figcaption>
</figure>
</div>
</div>
</div>
<p>Thirty iterations of the multiple imputation algorithm were run for each of ten independent imputations. <a href="#fig-marketimp">Figure&nbsp;<span>3.1</span></a> shows the density of the ten imputed market basket prices for a randomly selected set of 15 stores. As the figure reveals, there is some general peaking in the predicted market price for most stores, but the imputation model still predicts a wide range of possible prices for most stores. When using the imputed data for analysis, we take the mean of the ten predictions for continuous values, and the mode for discrete values.</p>
</section>
<section id="sec-mcls" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="sec-mcls"><span class="header-section-number">3.2.3</span> Travel Impedances</h3>
<p>The second element of the utility equation in <a href="#eq-utility">Equation&nbsp;<span>3.1</span></a> is the travel impedance between <span class="math inline">i</span> and <span class="math inline">j</span>. Many possibilities for representing this impedance exist, from basic euclidean distance to complex network paths. A primary purpose of the model we are developing in this research is to study comparative tradeoffs between infrastructure-focused and environment-focused improvements to the nutrition access of households. It is therefore essential that we use a travel impedance measure that can combine and compare the cost of traveling by multiple modes so that highway improvements and transit / active transport improvements can be compared in the same basic model.</p>
<div class="cell" data-hash="03_methods_cache/html/utilities_0a1ecb5e221116f8a95652f20ccbb41e">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tar_load</span>(utilities)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Just as the log-sum of a destination choice model is a measure that sums the utility of multiple destination attributes and costs in a rigorous manner, the log-sum of a mode choice model combines the utilities of all available travel modes. In this study we assert the following mode choice utility equations: <span class="math display">\begin{align*}
  V_{\mathrm{auto}, ij} &amp;= -0.028(t_{\mathrm{auto}, ij})\\
  V_{\mathrm{bus}, ij} &amp;= -4 -0.028(t_{\mathrm{bus}, ij}) -0.056(t_{\mathrm{wait}, ij}) -0.056(t_{\mathrm{access}, ij})\\
  V_{\mathrm{walk, ij}} &amp;= -5 -0.028(t_{\mathrm{walk}, ij}) -1.116(d_{ij&lt;1.5}) -5.58(d_{ij&gt;1.5})\\
\end{align*}</span> where <span class="math inline">t</span> is the in-vehicle travel time in minutes for each mode between <span class="math inline">i</span> and <span class="math inline">j</span>. The transit utility function additionally includes the wait time for transit as well as the time necessary to access the transit mode on both ends by walking. The walk utility includes a per-mile distance disutility that increases for distances greater than 1.5 miles. These equations and coefficients are adapted from a statewide mode choice model developed for UDOT research <span class="citation" data-cites="barnes2021">(<a href="references.html#ref-barnes2021" role="doc-biblioref">Barnes, 2021</a>)</span>.</p>
<p>The log-sum, or total weighted impedance by all modes is therefore <span id="eq-mcls"><span class="math display">
k_{ij} = \ln(e^{V_{\mathrm{auto}, ij}} + e^{V_{\mathrm{bus}, ij}} + e^{V_{\mathrm{walk},ij}})
\tag{3.4}</span></span></p>
<p>In this implementation, <span class="math inline">i</span> is the population-weighted centroid of a 2020 Census block group, and <span class="math inline">j</span> is an individual grocery store. We measure the travel times from each <span class="math inline">i</span> to each <span class="math inline">j</span> using the <code>r5r</code> implementation of the R5 routing engine <span class="citation" data-cites="pereira2021 conway2017 conway2018 conway2019">(<a href="references.html#ref-conway2017" role="doc-biblioref">Conway et al., 2017</a>, <a href="references.html#ref-conway2018" role="doc-biblioref">2018</a>; <a href="references.html#ref-conway2019" role="doc-biblioref">Conway &amp; Stewart, 2019</a>; <a href="references.html#ref-pereira2021" role="doc-biblioref">Pereira et al., 2021</a>)</span>. This algorithm uses common data elements — OpenStreetMap roadway and active transport networks alongside General Transit Feed Specification (GTFS) transit service files — to simulate multiple realistic route options by all requested modes. We obtained OpenStreetMap networks and the Utah Transit Authority GTFS file valid for May 2023 and requested the minimum total travel time by each mode of auto, transit, and walking for a departure between 8 AM and 9 AM on May 10, 2023. The total allowable trip time by any mode was set to 120 minutes, and the walk distance was capped at 10 kilometers; if a particular <span class="math inline">i,j</span> pair exceeded these parameters then the mode was presumed to not be available and contributes no utility to the log-sum.</p>
</section>
<section id="mobile-device-data" class="level3" data-number="3.2.4">
<h3 data-number="3.2.4" class="anchored" data-anchor-id="mobile-device-data"><span class="header-section-number">3.2.4</span> Mobile Device Data</h3>
<p>The final element of destination utility presented in <a href="#eq-utility">Equation&nbsp;<span>3.1</span></a> are the coefficients, which are often estimated from household travel surveys in a travel demand context. It is unlikely, however, that typical household diaries would include enough trips to grocery stores and similar destinations to create a representative sample.</p>
<p>Emerging mobile device data, however, could reveal the typical home locations for people who are observed in the space of a particular store. <span class="citation" data-cites="macfarlane2022a">Macfarlane et al. (<a href="references.html#ref-macfarlane2022a" role="doc-biblioref">2022</a>)</span> present a method for estimating destination choice models from such data, which we repeat in this study. We provided a set of geometric polygons for the grocery stores of interest to StreetLight Data, Inc., a commercial location-based services aggregator and reseller. StreetLight Data in turn provided data on the number of mobile devices observed in each polygon grouped by the inferred residence block group of those devices during summer 2022. We then created a simulated destination choice estimation dataset for each community resource by sampling 10,000 block group - grocery store “trips” from the StreetLight dataset. This created a “chosen” alternative; we then sampled ten additional stores from the same community at random (each simulated trip was paired with a different sampled store) to serve as the non-chosen alternatives. Random sampling of alternatives is a common practice that results in unbiased estimates, though the standard errors of the estimates might be larger than could be obtained through a more carefully designed sampling scheme <span class="citation" data-cites="train2009">(<a href="references.html#ref-train2009" role="doc-biblioref">Train, 2009</a>)</span>.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-line-spacing="2" role="list" style="display: none">
<div id="ref-barnes2021" class="csl-entry" role="listitem">
Barnes, M. (2021). <em>Resiliency of <span>Utah</span>’s <span>Road Network</span>: <span>A Logit-Based Approach</span></em> [{{MS Thesis}}]. Brigham Young University.
</div>
<div id="ref-ben-akiva1985" class="csl-entry" role="listitem">
Ben-Akiva, M., &amp; Lerman, S. R. (1985). <em>Discrete <span>Choice Analysis</span>: <span>Theory</span> and <span>Applications</span> to <span>Travel Demand</span></em>. <span>MIT Press</span>. <a href="https://www.jstor.org/stable/1391567">https://www.jstor.org/stable/1391567</a>
</div>
<div id="ref-conway2018" class="csl-entry" role="listitem">
Conway, M. W., Byrd, A., &amp; Eggermond, M. van. (2018). Accounting for uncertainty and variation in accessibility metrics for public transport sketch planning. <em>Journal of Transport and Land Use</em>, <em>11</em>(1). <a href="https://doi.org/10.5198/jtlu.2018.1074">https://doi.org/10.5198/jtlu.2018.1074</a>
</div>
<div id="ref-conway2017" class="csl-entry" role="listitem">
Conway, M. W., Byrd, A., &amp; van der Linden, M. (2017). Evidence-<span>Based Transit</span> and <span>Land Use Sketch Planning Using Interactive Accessibility Methods</span> on <span>Combined Schedule</span> and <span>Headway-Based Networks</span>. <em>Transportation Research Record</em>, <em>2653</em>(1), 45–53. <a href="https://doi.org/10.3141/2653-06">https://doi.org/10.3141/2653-06</a>
</div>
<div id="ref-conway2019" class="csl-entry" role="listitem">
Conway, M. W., &amp; Stewart, A. F. (2019). Getting <span>Charlie</span> off the <span>MTA</span>: A multiobjective optimization method to account for cost constraints in public transit accessibility metrics. <em>International Journal of Geographical Information Science</em>, <em>33</em>(9), 1759–1787. <a href="https://doi.org/10.1080/13658816.2019.1605075">https://doi.org/10.1080/13658816.2019.1605075</a>
</div>
<div id="ref-fns2021" class="csl-entry" role="listitem">
FNS. (2021). <em>Thrifty <span>Food Plan</span></em>. <span>Food and Nutrition Service, United States Department of Agriculture</span>.
</div>
<div id="ref-geurs2010" class="csl-entry" role="listitem">
Geurs, K., Zondag, B., de Jong, G., &amp; de Bok, M. (2010). Accessibility appraisal of land-use/transport policy strategies: <span>More</span> than just adding up travel-time savings. <em>Transportation Research Part D: Transport and Environment</em>, <em>15</em>(7), 382–393. <a href="https://doi.org/10.1016/j.trd.2010.04.006">https://doi.org/10.1016/j.trd.2010.04.006</a>
</div>
<div id="ref-glanz2007" class="csl-entry" role="listitem">
Glanz, K., Sallis, J. F., Saelens, B. E., &amp; Frank, L. D. (2007). Nutrition <span>Environment Measures Survey</span> in <span>Stores</span> (<span>NEMS-S</span>): <span>Development</span> and <span>Evaluation</span>. <em>American Journal of Preventive Medicine</em>, <em>32</em>(4), 282–289. <a href="https://doi.org/10.1016/j.amepre.2006.12.019">https://doi.org/10.1016/j.amepre.2006.12.019</a>
</div>
<div id="ref-hedrick2022" class="csl-entry" role="listitem">
Hedrick, V. E., Farris, A. R., Houghtaling, B., Mann, G., &amp; Misyak, S. A. (2022). Validity of a <span>Market Basket Assessment Tool</span> for <span>Use</span> in <span>Supplemental Nutrition Assistance Program Education Healthy Retail Initiatives</span>. <em>Journal of Nutrition Education and Behavior</em>, <em>54</em>(8), 776–783. <a href="https://doi.org/10.1016/j.jneb.2022.02.018">https://doi.org/10.1016/j.jneb.2022.02.018</a>
</div>
<div id="ref-kaczynski2016" class="csl-entry" role="listitem">
Kaczynski, A. T., Schipperijn, J., Hipp, J. A., Besenyi, G. M., Wilhelm Stanis, S. A., Hughey, S. M., &amp; Wilcox, S. (2016). <span>ParkIndex</span>: <span>Development</span> of a standardized metric of park access for research and planning. <em>Preventive Medicine</em>, <em>87</em>, 110–114. <a href="https://doi.org/10.1016/j.ypmed.2016.02.012">https://doi.org/10.1016/j.ypmed.2016.02.012</a>
</div>
<div id="ref-logan2019" class="csl-entry" role="listitem">
Logan, T., Williams, T., Nisbet, A., Liberman, K., Zuo, C., &amp; Guikema, S. (2019). Evaluating urban accessibility: Leveraging open-source data and analytics to overcome existing limitations. <em>Environment and Planning B: Urban Analytics and City Science</em>, <em>46</em>(5), 897–913. <a href="https://doi.org/10.1177/2399808317736528">https://doi.org/10.1177/2399808317736528</a>
</div>
<div id="ref-lunsford2021" class="csl-entry" role="listitem">
Lunsford, J., Brunt, A., Foote, J., Rhee, Y., Strand, M., &amp; Segall, M. (2021). Analysis of <span>Availability</span>, <span>Quality</span>, and <span>Price</span> of <span>Food Options</span> in <span>Denver</span>, <span>CO Grocery Stores</span>. <em>Journal of Hunger &amp; Environmental Nutrition</em>, <em>16</em>(3), 297–303. <a href="https://doi.org/10.1080/19320248.2020.1741482">https://doi.org/10.1080/19320248.2020.1741482</a>
</div>
<div id="ref-macfarlane2022a" class="csl-entry" role="listitem">
Macfarlane, G., Voulgaris, C. T., &amp; Tapia, T. (2022). City parks and slow streets: <span>A</span> utility-based access and equity analysis. <em>Journal of Transport and Land Use</em>, <em>15</em>(1), 587–612. <a href="https://doi.org/10.5198/jtlu.2022.2009">https://doi.org/10.5198/jtlu.2022.2009</a>
</div>
<div id="ref-mcfadden1974" class="csl-entry" role="listitem">
McFadden, D. (1974). Conditional logit analysis of qualitative choice behavior. In P. Zarembka (Ed.), <em>Frontiers in <span>Econometrics</span></em> (pp. 105–142). <span>Academic Press</span>.
</div>
<div id="ref-pereira2021" class="csl-entry" role="listitem">
Pereira, R. H. M., Saraiva, M., Herszenhut, D., Braga, C. K. V., &amp; Conway, M. W. (2021). R5r: <span>Rapid Realistic Routing</span> on <span>Multimodal Transport Networks</span> with <span>R</span><span><sup>5</sup></span> in <span>R</span>. <em>Findings</em>. <a href="https://doi.org/10.32866/001c.21262">https://doi.org/10.32866/001c.21262</a>
</div>
<div id="ref-recker1978" class="csl-entry" role="listitem">
Recker, W. W., &amp; Kostyniuk, L. P. (1978). Factors influencing destination choice for the urban grocery shopping trip. <em>Transportation</em>, <em>7</em>(1), 19–33. <a href="https://doi.org/10.1007/BF00148369">https://doi.org/10.1007/BF00148369</a>
</div>
<div id="ref-train2009" class="csl-entry" role="listitem">
Train, K. E. (2009). <em>Discrete <span>Choice Methods</span> with <span>Simulation</span></em> (2nd edition). <span>Cambridge University Press</span>.
</div>
<div id="ref-mice" class="csl-entry" role="listitem">
van Buuren, S., &amp; Groothuis-Oudshoorn, K. (2011). <span class="nocase">mice</span>: Multivariate imputation by chained equations in r. <em>Journal of Statistical Software</em>, <em>45</em>(3), 1–67. <a href="https://doi.org/10.18637/jss.v045.i03">https://doi.org/10.18637/jss.v045.i03</a>
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02_litreview.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Literature Review</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04_estimation.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Results</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>